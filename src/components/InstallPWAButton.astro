---
// <!-- import React, {useEffect, useState} from "react"; -->
// <!-- import {usePWA} from "./PWAProvider"; -->

// const InstallPWAButton = () => {
//  const [supportsPWA, setSupportsPWA] = useState(false);
//  const [promptEvent, setPromptEvent] = useState<any>(null);
---

<div class='space-y-6'>
  <button class='btn-prm fw-500 bf-i-ph-download-simple' id='pwa-install-button'> Ù†ØµØ¨ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†</button>
  <!-- {

      <div class='snack-warning'>
        <p>Ù…Ø±ÙˆØ±Ú¯Ø±â€Œ Ø´Ù…Ø§ Ø§Ø² Ù†ØµØ¨ PWA Ù¾ÛŒØ´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>
        <p>Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ù…Ø±ÙˆØ±Ú¯Ø± Ú©Ø±ÙˆÙ… Ø¨Ø±Ø§ÛŒ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ Ùˆ ÙˆÛŒÙ†Ø¯ÙˆØ²ØŒ Ùˆ Ù…Ø±ÙˆØ±Ú¯Ø± Ø³Ø§ÙØ§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ iOS Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
        <p>
          ÙÙ‡Ø±Ø³Øª Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ÛŒ Ø¯Ø§Ø±Ø§ÛŒ Ø§Ù…Ú©Ø§Ù†Ø§Øª PWA Ø±Ø§
          {` `}
          <a href='https://caniuse.com/web-app-manifest'> Ø§Ø² Ø§ÛŒÙ†Ø¬Ø§</a>
          {` `}
          Ø¨Ø¨ÛŒÙ†ÛŒØ¯.
        </p>
      </div>
  } -->
</div>

<script>
  let promptEvent: Event | null = null;
  let installed = false;
  // const handler: EventListenerOrEventListenerObject =
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    console.log('before install...');
    promptEvent = e;
    console.log('ğŸš€ ~ promptEvent:', promptEvent);
  });

  const pwaInstallButton = document.querySelector('#pwa-install-button');

  // pwaInstallButton?.addEventListener('click', async (e) => {
  //   e.preventDefault();
  //   console.log('ğŸš€ ~ promptEvent:', promptEvent);

  //   if (promptEvent === null) return;
  //   const result = await promptEvent.userChoice;
  //   promptEvent = null;
  //   console.log('ğŸš€ ~ result:', result);
  // });

  // let installed = false;
  pwaInstallButton?.addEventListener('click', async function (e) {
    e.preventDefault();
    console.log('ğŸš€ ~ promptEvent:', promptEvent);
    // if (promptEvent === null) return;
    promptEvent?.prompt();
    let result = await promptEvent.userChoice;
    if (result && result.outcome === 'accepted') {
      installed = true;
    }
    promptEvent = null;
  });
</script>
