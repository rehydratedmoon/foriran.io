---
import GlobalLayout from '../layouts/GlobalLayout.astro';
import Person from '../components/card/Person.astro';
import neo4j from 'neo4j-driver';
const driver = neo4j.driver(
  import.meta.env.DB_URI,
  neo4j.auth.basic(import.meta.env.DB_USERNAME, import.meta.env.DB_PASSWORD)
);

const session = driver.session();
let records = null;
try {
  const result = await session.run('MATCH (a:Person) RETURN a');
  records = result.records.map((rec) => rec.get(0));
} catch (err) {
  console.log('ğŸš€ ~ err:', err);
} finally {
  await session.close();
}
console.log('ğŸš€ ~ records:', records);
---

<GlobalLayout title='Ø§ÙØ±Ø§Ø¯ Ù…Ù‡Ù…'>
  <h1 class='H1'>Ø§ÙØ±Ø§Ø¯ Ù…Ù‡Ù…</h1>
  <p>ÙÙ‡Ø±Ø³ØªÛŒ Ø§Ø² Ø§ÙØ±Ø§Ø¯ÛŒ Ú©Ù‡ Ø¯Ø± Ø®ÛŒØ²Ø´ Ø²Ù† Ø²Ù†Ø¯Ú¯ÛŒ Ø¢Ø²Ø§Ø¯ÛŒ Ù…Ø·Ø±Ø­ Ø¨ÙˆØ¯Ù†Ø¯</p>
  <ul class='mt-10 list-none grid grid-min-col-15rem gap-4'>
    {records?.map((person) => <Person data={person.properties} />)}
  </ul>
</GlobalLayout>
